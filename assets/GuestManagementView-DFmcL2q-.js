import{u as K,i as X,a as o,j as e,G as Y}from"./index-BuuUsEeF.js";import{r as n}from"./react-vendor-DSgMQvCA.js";import{M as Z,R as _,I as ee}from"./ImportWizard-CMSagWRr.js";import{E as se}from"./EmptyState-BiKYMC-5.js";import"./pdf-export-BqwfyxvF.js";import"./compression-B61UvNVp.js";import"./qrcode-CZEObl3k.js";import"./gesture-BYLw3qxJ.js";import"./excel-import-eTqe3OYc.js";function he(){const{event:r,removeGuest:k,updateGuest:R,assignGuestToTable:E}=K(),{onShowHelp:M,onStartTour:T,onSubscribe:V,canShowEmailButton:$}=X(),[N,w]=n.useState("list"),[d,L]=n.useState(""),[i,h]=n.useState(new Set),[u,P]=n.useState("name"),[g,y]=n.useState("asc"),[p,B]=n.useState("all"),[m,F]=n.useState("all"),[W,S]=n.useState(!1),[G,f]=n.useState(null),[C,z]=n.useState(null),[D,A]=n.useState(!1),Q=n.useCallback(s=>s&&r.tables.find(l=>l.id===s)?.name||null,[r.tables]),x=n.useMemo(()=>{const s=l=>l&&r.tables.find(j=>j.id===l)?.name||null;let t=[...r.guests];if(d){const l=d.toLowerCase();t=t.filter(c=>o(c).toLowerCase().includes(l)||c.email?.toLowerCase().includes(l)||c.company?.toLowerCase().includes(l)||c.group?.toLowerCase().includes(l))}return p!=="all"&&(t=t.filter(l=>l.rsvpStatus===p)),m==="assigned"?t=t.filter(l=>l.tableId):m==="unassigned"&&(t=t.filter(l=>!l.tableId)),t.sort((l,c)=>{let j="",v="";switch(u){case"name":j=o(l),v=o(c);break;case"group":j=l.group||"",v=c.group||"";break;case"rsvpStatus":j=l.rsvpStatus,v=c.rsvpStatus;break;case"table":j=s(l.tableId)||"zzz",v=s(c.tableId)||"zzz";break}const I=j.localeCompare(v);return g==="asc"?I:-I}),t},[r.guests,r.tables,d,p,m,u,g]),b=s=>{u===s?y(t=>t==="asc"?"desc":"asc"):(P(s),y("asc"))},U=s=>{const t=new Set(i);t.has(s)?t.delete(s):t.add(s),h(t)},q=()=>{i.size===x.length?h(new Set):h(new Set(x.map(s=>s.id)))},H=()=>{confirm(`Delete ${i.size} selected guests?`)&&(i.forEach(s=>k(s)),h(new Set))},O=s=>{i.forEach(t=>E(t,s)),h(new Set)},J=s=>{i.forEach(t=>R(t,{rsvpStatus:s})),h(new Set)},a=C?r.guests.find(s=>s.id===C):null;return e.jsxs("div",{className:"guest-management-view",children:[e.jsxs(Z,{onAddGuest:()=>S(!0),onImport:()=>A(!0),showRelationships:N==="relationships",onToggleRelationships:()=>w(N==="relationships"?"list":"relationships"),onShowHelp:M,onStartTour:T,onSubscribe:V,canShowEmailButton:$,children:[e.jsx("input",{type:"text",placeholder:"Search guests...",value:d,onChange:s=>L(s.target.value),className:"search-input"}),e.jsxs("select",{value:p,onChange:s=>B(s.target.value),className:"filter-select",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"declined",children:"Declined"})]}),e.jsxs("select",{value:m,onChange:s=>F(s.target.value),className:"filter-select",children:[e.jsx("option",{value:"all",children:"All Guests"}),e.jsx("option",{value:"assigned",children:"Assigned"}),e.jsx("option",{value:"unassigned",children:"Unassigned"})]}),e.jsxs("span",{className:"guest-count",children:[x.length," guests"]})]}),i.size>0&&e.jsxs("div",{className:"bulk-actions-bar",children:[e.jsxs("span",{className:"selection-count",children:[i.size," selected"]}),e.jsxs("select",{onChange:s=>{s.target.value&&(O(s.target.value),s.target.value="")},className:"bulk-select",defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Assign to table..."}),r.tables.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsxs("select",{onChange:s=>{s.target.value&&(J(s.target.value),s.target.value="")},className:"bulk-select",defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Change status..."}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"declined",children:"Declined"})]}),e.jsx("button",{className:"bulk-btn danger",onClick:H,children:"Delete"}),e.jsx("button",{className:"bulk-btn clear",onClick:()=>h(new Set),children:"Clear"})]}),e.jsxs("div",{className:"gm-content",children:[e.jsx("div",{className:"guest-table-container",children:x.length===0?e.jsx(se,{variant:d||p!=="all"||m!=="all"?"search":"guests",title:d||p!=="all"||m!=="all"?"No guests match your filters":"No guests yet",description:d||p!=="all"||m!=="all"?"Try adjusting your search or filter criteria.":"Start by adding your first guest to the event.",action:{label:"+ Add Guest",onClick:()=>S(!0)}}):e.jsxs("table",{className:"guest-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"checkbox-col",children:e.jsx("input",{type:"checkbox",checked:i.size===x.length&&x.length>0,onChange:q})}),e.jsxs("th",{className:"sortable",onClick:()=>b("name"),children:["Name ",u==="name"&&(g==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"sortable",onClick:()=>b("group"),children:["Group ",u==="group"&&(g==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"sortable",onClick:()=>b("rsvpStatus"),children:["RSVP ",u==="rsvpStatus"&&(g==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"sortable",onClick:()=>b("table"),children:["Table ",u==="table"&&(g==="asc"?"↑":"↓")]}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:x.map(s=>e.jsxs("tr",{className:`${i.has(s.id)?"selected":""} ${C===s.id?"highlighted":""}`,onClick:()=>z(s.id),children:[e.jsx("td",{className:"checkbox-col",onClick:t=>t.stopPropagation(),children:e.jsx("input",{type:"checkbox",checked:i.has(s.id),onChange:()=>U(s.id)})}),e.jsx("td",{children:e.jsxs("div",{className:"guest-name-cell",children:[e.jsx("div",{className:"guest-avatar",children:o(s).split(" ").map(t=>t[0]).join("").slice(0,2)}),e.jsxs("div",{children:[e.jsx("span",{className:"guest-name",children:o(s)}),s.company&&e.jsx("span",{className:"guest-company",children:s.company})]})]})}),e.jsx("td",{children:s.group?e.jsx("span",{className:"group-chip",children:s.group}):e.jsx("span",{className:"no-group",children:"—"})}),e.jsx("td",{children:e.jsx("span",{className:`rsvp-badge ${s.rsvpStatus}`,children:s.rsvpStatus})}),e.jsx("td",{children:s.tableId?e.jsx("span",{className:"table-badge",children:Q(s.tableId)}):e.jsx("span",{className:"unassigned",children:"Unassigned"})}),e.jsx("td",{onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"row-actions",children:[e.jsx("button",{className:"action-icon-btn",onClick:()=>f(s),children:"Edit"}),e.jsx("button",{className:"action-icon-btn danger",onClick:()=>{confirm(`Delete ${o(s)}?`)&&k(s.id)},children:"Del"})]})})]},s.id))})]})}),a&&e.jsxs("div",{className:"guest-detail-panel",children:[e.jsxs("div",{className:"detail-header",children:[e.jsx("h3",{children:"Guest Details"}),e.jsx("button",{className:"close-btn",onClick:()=>z(null),children:"×"})]}),e.jsxs("div",{className:"detail-content",children:[e.jsx("div",{className:"detail-avatar",children:o(a).split(" ").map(s=>s[0]).join("").slice(0,2)}),e.jsx("h2",{children:o(a)}),a.email&&e.jsx("p",{className:"detail-email",children:a.email}),a.company&&e.jsx("p",{className:"detail-company",children:a.company}),e.jsxs("div",{className:"detail-badges",children:[e.jsx("span",{className:`rsvp-badge ${a.rsvpStatus}`,children:a.rsvpStatus}),a.group&&e.jsx("span",{className:"group-chip",children:a.group})]}),a.interests&&a.interests.length>0&&e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"Interests"}),e.jsx("div",{className:"tag-list",children:a.interests.map(s=>e.jsx("span",{className:"tag",children:s},s))})]}),a.dietaryRestrictions&&a.dietaryRestrictions.length>0&&e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"Dietary Restrictions"}),e.jsx("div",{className:"tag-list",children:a.dietaryRestrictions.map(s=>e.jsx("span",{className:"tag warning",children:s},s))})]}),a.relationships.length>0&&e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"Relationships"}),e.jsx("div",{className:"relationships-list",children:a.relationships.map(s=>{const t=r.guests.find(l=>l.id===s.guestId);return t?e.jsxs("div",{className:`relationship-item ${s.type}`,children:[e.jsx("span",{className:"rel-name",children:o(t)}),e.jsx("span",{className:"rel-type",children:s.type})]},s.guestId):null})})]}),a.notes&&e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"Notes"}),e.jsx("p",{className:"notes-text",children:a.notes})]}),e.jsx("div",{className:"detail-actions",children:e.jsx("button",{className:"detail-btn",onClick:()=>f(a),children:"Edit Guest"})})]})]})]}),N==="relationships"&&e.jsxs("div",{className:"relationships-panel",children:[e.jsxs("div",{className:"relationships-panel-header",children:[e.jsx("h3",{children:"Guest Relationships"}),e.jsx("button",{className:"close-btn",onClick:()=>w("list"),children:"×"})]}),e.jsx(_,{})]}),(W||G)&&e.jsx(Y,{guestId:G?.id,onClose:()=>{S(!1),f(null)}}),D&&e.jsx(ee,{isOpen:D,onClose:()=>A(!1)})]})}export{he as GuestManagementView};
