const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdf-export-BqwfyxvF.js","assets/compression-B61UvNVp.js"])))=>i.map(i=>d[i]);
import{j as e,u as X,d as pe,Q as fe,O as ve,l as xe,S as ge,E as be,s as L,t as je,m as Ne,n as we,o as Ce,p as ye,q as Se,r as Pe}from"./index-Ch-N2Ac2.js";import{r as g}from"./react-vendor-DSgMQvCA.js";import{E as Te}from"./EmptyState-C72rFsXI.js";import{_ as Fe}from"./pdf-export-BqwfyxvF.js";import"./qrcode-CZEObl3k.js";import"./compression-B61UvNVp.js";import"./gesture-BYLw3qxJ.js";function R({value:a,duration:l=400,className:r=""}){const[c,d]=g.useState(a),h=g.useRef(a),n=g.useRef(void 0);return g.useEffect(()=>{const u=h.current,b=a,v=performance.now();if(u===b)return;const N=i=>{const x=i-v,o=Math.min(x/l,1),p=1-Math.pow(1-o,3),w=Math.round(u+(b-u)*p);d(w),o<1?n.current=requestAnimationFrame(N):h.current=b};return n.current=requestAnimationFrame(N),()=>{n.current&&cancelAnimationFrame(n.current)}},[a,l]),e.jsx("span",{className:r,children:c})}function ke({onClose:a}){const l=g.useRef(null),{event:r}=X();if(!r)return null;const c=r.tables,d=()=>{window.print()},h=n=>r.guests.filter(u=>u.tableId===n&&u.rsvpStatus==="confirmed").length;return e.jsxs("div",{className:"qr-print-view",children:[e.jsxs("div",{className:"qr-print-header no-print",children:[e.jsxs("div",{className:"qr-print-header-content",children:[e.jsx("h2",{children:"Print All QR Codes"}),e.jsxs("p",{className:"qr-print-subtitle",children:[c.length," table",c.length!==1?"s":""," â€¢"," ",r.name]})]}),e.jsxs("div",{className:"qr-print-actions",children:[e.jsx("button",{className:"btn-secondary",onClick:a,children:"Cancel"}),e.jsxs("button",{className:"btn-primary",onClick:d,children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("polyline",{points:"6 9 6 2 18 2 18 9"}),e.jsx("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}),e.jsx("rect",{x:"6",y:"14",width:"12",height:"8"})]}),"Print QR Codes"]})]})]}),e.jsxs("div",{className:"qr-print-content",ref:l,children:[e.jsxs("div",{className:"print-title print-only",children:[e.jsx("h1",{children:r.name}),r.date&&e.jsx("p",{className:"event-date",children:r.date}),e.jsx("p",{className:"subtitle",children:"Table QR Codes"})]}),e.jsx("div",{className:"qr-grid",children:c.map(n=>{const u=pe(r,n),b=h(n.id);return e.jsxs("div",{className:"qr-card",children:[e.jsx("div",{className:"qr-code-wrapper",children:e.jsx(fe,{value:u,size:150,level:"M",bgColor:"#ffffff",fgColor:"#000000"})}),e.jsxs("div",{className:"qr-card-info",children:[e.jsx("h3",{className:"table-name",children:n.name}),e.jsxs("p",{className:"table-meta",children:[b," guest",b!==1?"s":""," â€¢"," ",n.capacity," seats"]})]}),e.jsx("p",{className:"scan-hint",children:"Scan to view tablemates"})]},n.id)})}),e.jsx("div",{className:"print-footer print-only",children:e.jsx("p",{children:"Generated by Seatify"})})]})]})}const Ee=[{value:"classic",label:"Classic",color:"#F97066"},{value:"elegant",label:"Elegant",color:"#B8860B"},{value:"modern",label:"Modern",color:"#3B82F6"},{value:"nature",label:"Nature",color:"#059669"},{value:"romantic",label:"Romantic",color:"#EC4899"}],De=[{value:"compact",label:"Compact",description:"More cards per page"},{value:"standard",label:"Standard",description:"Balanced size"},{value:"large",label:"Large",description:"High visibility"}],Y={includeTableName:!0,includeDietary:!0,fontSize:"medium",fontFamily:"helvetica",colorTheme:"classic",cardSize:"standard"},Z={fontSize:"medium",fontFamily:"helvetica",showGuestCount:!0,showEventName:!0,colorTheme:"classic",cardSize:"standard"};function ze({isOpen:a,onClose:l,pdfUrl:r,title:c,onDownload:d,isGenerating:h=!1,type:n,onOptionsChange:u}){const b=g.useRef(null),[v,N]=g.useState(Y),[i,x]=g.useState(Z),[o,p]=g.useState(!0);if(g.useEffect(()=>{const t=P=>{P.key==="Escape"&&l()};return a&&(document.addEventListener("keydown",t),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",t),document.body.style.overflow=""}},[a,l]),g.useEffect(()=>()=>{r&&r.startsWith("blob:")&&URL.revokeObjectURL(r)},[r]),g.useEffect(()=>{a&&(N(Y),x(Z),p(!0))},[a]),!a)return null;const w=t=>{t.target===t.currentTarget&&l()},f=(t,P)=>{const S={...v,[t]:P};N(S),u?.(S,void 0)},j=(t,P)=>{const S={...i,[t]:P};x(S),u?.(void 0,S)},y=()=>{d(n==="place"?v:void 0,n==="table"?i:void 0)};return e.jsx("div",{className:"pdf-preview-overlay",onClick:w,children:e.jsxs("div",{className:"pdf-preview-modal",ref:b,children:[e.jsxs("div",{className:"pdf-preview-header",children:[e.jsx("h2",{children:c}),e.jsxs("div",{className:"pdf-preview-actions",children:[e.jsx("button",{className:`pdf-preview-btn options ${o?"active":""}`,onClick:()=>p(!o),title:"Customize options",children:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"3"}),e.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),e.jsxs("button",{className:"pdf-preview-btn download",onClick:y,disabled:h||!r,children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"Download PDF"]}),e.jsx("button",{className:"pdf-preview-btn close",onClick:l,children:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]}),o&&e.jsxs("div",{className:"pdf-options-panel",children:[n==="place"&&e.jsxs("div",{className:"pdf-option-group",children:[e.jsxs("label",{className:"pdf-option-label",children:[e.jsx("input",{type:"checkbox",checked:v.includeTableName,onChange:t=>f("includeTableName",t.target.checked)}),e.jsx("span",{children:"Show table name"})]}),e.jsxs("label",{className:"pdf-option-label",children:[e.jsx("input",{type:"checkbox",checked:v.includeDietary,onChange:t=>f("includeDietary",t.target.checked)}),e.jsx("span",{children:"Show dietary icons"})]})]}),n==="table"&&e.jsxs("div",{className:"pdf-option-group",children:[e.jsxs("label",{className:"pdf-option-label",children:[e.jsx("input",{type:"checkbox",checked:i.showGuestCount,onChange:t=>j("showGuestCount",t.target.checked)}),e.jsx("span",{children:"Show guest count"})]}),e.jsxs("label",{className:"pdf-option-label",children:[e.jsx("input",{type:"checkbox",checked:i.showEventName,onChange:t=>j("showEventName",t.target.checked)}),e.jsx("span",{children:"Show event name"})]})]}),e.jsxs("div",{className:"pdf-option-group",children:[e.jsx("span",{className:"pdf-option-title",children:"Font Size"}),e.jsx("div",{className:"pdf-font-size-options",children:["small","medium","large"].map(t=>e.jsxs("label",{className:"pdf-font-option",children:[e.jsx("input",{type:"radio",name:"fontSize",value:t,checked:n==="place"?v.fontSize===t:i.fontSize===t,onChange:()=>n==="place"?f("fontSize",t):j("fontSize",t)}),e.jsx("span",{className:`pdf-font-label pdf-font-${t}`,children:t.charAt(0).toUpperCase()+t.slice(1)})]},t))})]}),e.jsxs("div",{className:"pdf-option-group",children:[e.jsx("span",{className:"pdf-option-title",children:"Font Style"}),e.jsx("div",{className:"pdf-font-size-options",children:[{value:"helvetica",label:"Sans-serif"},{value:"times",label:"Serif"},{value:"courier",label:"Monospace"}].map(t=>e.jsxs("label",{className:"pdf-font-option",children:[e.jsx("input",{type:"radio",name:"fontFamily",value:t.value,checked:n==="place"?v.fontFamily===t.value:i.fontFamily===t.value,onChange:()=>n==="place"?f("fontFamily",t.value):j("fontFamily",t.value)}),e.jsx("span",{className:`pdf-font-label pdf-font-family-${t.value}`,children:t.label})]},t.value))})]}),e.jsxs("div",{className:"pdf-option-group",children:[e.jsx("span",{className:"pdf-option-title",children:"Color Theme"}),e.jsx("div",{className:"pdf-theme-options",children:Ee.map(t=>e.jsxs("label",{className:"pdf-theme-option",children:[e.jsx("input",{type:"radio",name:"colorTheme",value:t.value,checked:n==="place"?v.colorTheme===t.value:i.colorTheme===t.value,onChange:()=>n==="place"?f("colorTheme",t.value):j("colorTheme",t.value)}),e.jsx("span",{className:"pdf-theme-swatch",style:{backgroundColor:t.color}}),e.jsx("span",{className:"pdf-theme-label",children:t.label})]},t.value))})]}),e.jsxs("div",{className:"pdf-option-group",children:[e.jsx("span",{className:"pdf-option-title",children:"Card Size"}),e.jsx("div",{className:"pdf-size-options",children:De.map(t=>e.jsxs("label",{className:"pdf-size-option",title:t.description,children:[e.jsx("input",{type:"radio",name:"cardSize",value:t.value,checked:n==="place"?v.cardSize===t.value:i.cardSize===t.value,onChange:()=>n==="place"?f("cardSize",t.value):j("cardSize",t.value)}),e.jsx("span",{className:"pdf-size-label",children:t.label})]},t.value))})]}),e.jsx("p",{className:"pdf-options-note",children:"Changes will apply when you download"})]}),e.jsx("div",{className:"pdf-preview-content",children:h?e.jsxs("div",{className:"pdf-preview-loading",children:[e.jsx("div",{className:"pdf-preview-spinner"}),e.jsx("p",{children:"Generating preview..."})]}):r?e.jsx("iframe",{src:r,className:"pdf-preview-iframe",title:"PDF Preview"}):e.jsx("div",{className:"pdf-preview-empty",children:e.jsx("p",{children:"Unable to generate preview"})})})]})})}let W=null;async function ee(){return W||(W=await Fe(()=>import("./pdf-export-BqwfyxvF.js").then(a=>a.j),__vite__mapDeps([0,1])),W)}const Le={compact:{width:76.2,height:50.8,margin:6},standard:{width:101.6,height:76.2,margin:10},large:{width:127,height:101.6,margin:12}},Re={compact:{width:63.5,height:38.1,margin:4},standard:{width:88.9,height:50.8,margin:5},large:{width:101.6,height:63.5,margin:6}},Me={primary:"#F97066",text:"#1a1a1a",textLight:"#666666",border:"#e5e5e5"},Ge={classic:{primary:"#F97066",text:"#1a1a1a",textLight:"#666666",border:"#e5e5e5"},elegant:{primary:"#B8860B",text:"#2c2c2c",textLight:"#5a5a5a",border:"#d4d4d4"},modern:{primary:"#3B82F6",text:"#1f2937",textLight:"#6b7280",border:"#e5e7eb"},nature:{primary:"#059669",text:"#1a1a1a",textLight:"#4b5563",border:"#d1d5db"},romantic:{primary:"#EC4899",text:"#1f1f1f",textLight:"#6b6b6b",border:"#f3e8ec"}};function ae(a){return a?Ge[a]:Me}async function te(a,l,r={}){const{fontSize:c="medium",fontFamily:d="helvetica",showGuestCount:h=!0,showEventName:n=!0,colorTheme:u,cardSize:b="standard"}=r,v=Ae[c],N=ae(u),i=Le[b],{jsPDF:x}=await ee(),o=new x({orientation:"landscape",unit:"mm",format:"letter"}),p=o.internal.pageSize.getWidth(),w=o.internal.pageSize.getHeight(),f=Math.floor(p/(i.width+5))||1,j=Math.floor(w/(i.height+5))||1,y=f*j,t=i.width*f+5*(f-1),P=i.height*j+5*(j-1),S=(p-t)/2,M=(w-P)/2;return l.forEach((O,F)=>{F>0&&F%y===0&&o.addPage();const _=F%y,E=_%f,D=Math.floor(_/f),z=S+E*(i.width+5),T=M+D*(i.height+5);Oe(o,O,a,z,T,{fontSizes:v,fontFamily:d,showGuestCount:h,showEventName:n,themeColors:N,cardDimensions:i})}),o}function Oe(a,l,r,c,d,h){const{fontSizes:n,fontFamily:u,showGuestCount:b,showEventName:v,themeColors:N,cardDimensions:i}=h,{width:x,height:o,margin:p}=i;a.setDrawColor(N.border),a.setLineDashPattern([2,2],0),a.rect(c,d,x,o);const w=d+o/2;a.setLineDashPattern([1,1],0),a.line(c+p,w,c+x-p,w),a.setLineDashPattern([],0),a.setDrawColor(N.primary),a.setLineWidth(1.5),a.line(c+p,d+p,c+x-p,d+p),a.line(c+p,w+p,c+x-p,w+p),a.setLineWidth(.2);const f=r.guests.filter(t=>t.tableId===l.id).length;a.saveGraphicsState(),a.setFontSize(n.tableName),a.setFont(u,"bold"),a.setTextColor(N.text);const j=d+o/4;a.text(l.name,c+x/2,j,{align:"center",baseline:"middle"}),b&&(a.setFontSize(n.guestCount),a.setFont(u,"normal"),a.setTextColor(N.textLight),a.text(`${f} / ${l.capacity} guests`,c+x/2,j+12,{align:"center"})),a.restoreGraphicsState();const y=d+o*3/4;a.setFontSize(n.tableName),a.setFont(u,"bold"),a.setTextColor(N.text),a.text(l.name,c+x/2,y,{align:"center",baseline:"middle"}),v&&(a.setFontSize(n.eventName),a.setFont(u,"italic"),a.setTextColor(N.textLight),a.text(r.name,c+x/2,d+o-p,{align:"center"}))}const _e={small:{guestName:12,tableName:9,dietary:7,eventName:6},medium:{guestName:16,tableName:11,dietary:8,eventName:7},large:{guestName:20,tableName:13,dietary:9,eventName:8}},Ae={small:{tableName:22,guestCount:10,eventName:7},medium:{tableName:28,guestCount:12,eventName:9},large:{tableName:34,guestCount:14,eventName:11}};async function se(a,l,r={}){const{includeTableName:c=!0,includeDietary:d=!0,fontSize:h="medium",fontFamily:n="helvetica",colorTheme:u,cardSize:b="standard"}=r,v=_e[h],N=ae(u),i=Re[b],{jsPDF:x}=await ee(),o=new x({orientation:"landscape",unit:"mm",format:"letter"}),p=o.internal.pageSize.getWidth(),w=o.internal.pageSize.getHeight(),f=5,j=5,y=Math.floor((p+f)/(i.width+f))||1,t=Math.floor((w+j)/(i.height+j))||1,P=y*t,S=i.width*y+f*(y-1),M=i.height*t+j*(t-1),O=(p-S)/2,F=(w-M)/2;return[...l].sort((E,D)=>{const z=a.tables.find(k=>k.id===E.tableId)?.name||"",T=a.tables.find(k=>k.id===D.tableId)?.name||"";return z!==T?z.localeCompare(T):`${E.firstName} ${E.lastName}`.localeCompare(`${D.firstName} ${D.lastName}`)}).forEach((E,D)=>{D>0&&D%P===0&&o.addPage();const z=D%P,T=z%y,k=Math.floor(z/y),A=O+T*(i.width+f),I=F+k*(i.height+j),B=a.tables.find(G=>G.id===E.tableId);We(o,E,B,a,A,I,{includeTableName:c,includeDietary:d,fontSizes:v,fontFamily:n,themeColors:N,cardDimensions:i})}),o}function We(a,l,r,c,d,h,n){const{fontSizes:u,fontFamily:b,themeColors:v,cardDimensions:N}=n,{width:i,height:x,margin:o}=N;a.setDrawColor(v.border),a.setLineDashPattern([2,2],0),a.rect(d,h,i,x),a.setLineDashPattern([],0),a.setDrawColor(v.primary),a.setLineWidth(1),a.line(d+o,h+o,d+i-o,h+o),a.setLineWidth(.2);const p=`${l.firstName} ${l.lastName}`.trim();a.setFontSize(u.guestName),a.setFont(b,"bold"),a.setTextColor(v.text);const w=h+x/2-(n.includeTableName?4:0);if(a.text(p,d+i/2,w,{align:"center",baseline:"middle"}),n.includeTableName&&r&&(a.setFontSize(u.tableName),a.setFont(b,"normal"),a.setTextColor(v.textLight),a.text(r.name,d+i/2,w+8,{align:"center"})),n.includeDietary){const f=[];l.dietaryRestrictions?.length&&f.push(...l.dietaryRestrictions.map(j=>Ie(j))),l.accessibilityNeeds?.length&&f.push("â™¿"),f.length>0&&(a.setFontSize(u.dietary),a.setTextColor(v.textLight),a.text(f.join(" "),d+i-o,h+x-o,{align:"right"}))}a.setFontSize(u.eventName),a.setFont(b,"italic"),a.setTextColor(v.textLight),a.text(c.name,d+o,h+x-o)}function Ie(a){return{vegetarian:"ðŸŒ±",vegan:"ðŸŒ¿","gluten-free":"GF","dairy-free":"DF","nut-free":"NF",halal:"â˜ª",kosher:"âœ¡",pescatarian:"ðŸŸ"}[a.toLowerCase()]||a.charAt(0).toUpperCase()}function ne(a,l){a.save(`${l}.pdf`)}function re(a){return a.output("blob")}async function J(a,l){if(a.tables.length===0)return null;const r=await te(a,a.tables,l),c=re(r);return URL.createObjectURL(c)}async function K(a,l){const r=a.guests.filter(h=>h.tableId&&h.rsvpStatus==="confirmed");if(r.length===0)return null;const c=await se(a,r,l),d=re(c);return URL.createObjectURL(d)}async function Be(a,l){if(a.tables.length===0)return;const r=await te(a,a.tables,l),c=`${a.name.replace(/\s+/g,"-").toLowerCase()}-table-cards`;ne(r,c)}async function Ve(a,l){const r=a.guests.filter(h=>h.tableId&&h.rsvpStatus==="confirmed");if(r.length===0)return;const c=await se(a,r,l),d=`${a.name.replace(/\s+/g,"-").toLowerCase()}-place-cards`;ne(c,d)}function Je(){const{event:a,setActiveView:l,setEventName:r,setEventType:c,exportEvent:d}=X(),[h,n]=g.useState(!1),[u,b]=g.useState(!1),[v,N]=g.useState(!1),[i,x]=g.useState(!1),[o,p]=g.useState(!1),[w,f]=g.useState(!1),[j,y]=g.useState(!1),[t,P]=g.useState(null),[S,M]=g.useState("table"),[O,F]=g.useState(!1),[_,E]=g.useState(),[D,z]=g.useState(),T=a.guests.length,k=a.tables.length,A=a.guests.filter(s=>s.rsvpStatus==="confirmed").length,I=a.guests.filter(s=>s.rsvpStatus==="pending").length,B=a.guests.filter(s=>s.rsvpStatus==="declined").length,G=a.guests.filter(s=>s.tableId).length,le=T-G,H=T>0?Math.round(G/T*100):0,U=a.tables.reduce((s,m)=>s+m.capacity,0),$=()=>{Se("exportAttempt")&&(Pe("exportAttempt"),setTimeout(()=>f(!0),500))},q=(s=!1)=>{s?Ce():ye(),f(!1)},ie=()=>{const s=d(),m=new Blob([s],{type:"application/json"}),C=URL.createObjectURL(m),V=document.createElement("a");V.href=C,V.download=`${a.name.replace(/\s+/g,"-").toLowerCase()}-seating.json`,V.click(),URL.revokeObjectURL(C),$()},oe=async()=>{if(k===0){L("Add tables first to preview table cards","warning");return}M("table"),y(!0),F(!0);try{const s=await J(a);P(s)}catch(s){console.error("Failed to generate preview:",s),L("Failed to generate preview. Please try again.","error"),y(!1)}finally{F(!1)}},ce=async()=>{if(a.guests.filter(m=>m.tableId&&m.rsvpStatus==="confirmed").length===0){L("Assign confirmed guests to tables first","warning");return}M("place"),y(!0),F(!0);try{const m=await K(a);P(m)}catch(m){console.error("Failed to generate preview:",m),L("Failed to generate preview. Please try again.","error"),y(!1)}finally{F(!1)}},Q=()=>{t&&URL.revokeObjectURL(t),P(null),y(!1),E(void 0),z(void 0)},de=async(s,m)=>{s&&E(s),m&&z(m),t&&URL.revokeObjectURL(t),F(!0);try{let C=null;S==="table"&&m?C=await J(a,{fontSize:m.fontSize,fontFamily:m.fontFamily,showGuestCount:m.showGuestCount,showEventName:m.showEventName,colorTheme:m.colorTheme,cardSize:m.cardSize}):S==="place"&&s&&(C=await K(a,{includeTableName:s.includeTableName,includeDietary:s.includeDietary,fontSize:s.fontSize,fontFamily:s.fontFamily,colorTheme:s.colorTheme,cardSize:s.cardSize})),P(C)}catch(C){console.error("Failed to regenerate preview:",C)}finally{F(!1)}},he=(s,m)=>{const C=S==="table"?"table_cards":"place_cards";S==="table"?me(m??D):ue(s??_),je(C),Ne("export_completed",{export_type:C}),we("first_export",{export_type:C}),Q(),$()},me=async s=>{if(k===0){L("Add tables first to generate table cards","warning");return}x(!0);try{await Be(a,{fontSize:s?.fontSize??"medium",fontFamily:s?.fontFamily??"helvetica",showGuestCount:s?.showGuestCount??!0,showEventName:s?.showEventName??!0,colorTheme:s?.colorTheme??"classic",cardSize:s?.cardSize??"standard"}),L("Table cards PDF downloaded","success")}catch(m){console.error("Failed to generate table cards:",m),L("Failed to generate PDF. Please try again.","error")}finally{x(!1)}},ue=async s=>{if(a.guests.filter(C=>C.tableId&&C.rsvpStatus==="confirmed").length===0){L("Assign confirmed guests to tables first","warning");return}p(!0);try{await Ve(a,{includeTableName:s?.includeTableName??!0,includeDietary:s?.includeDietary??!0,fontSize:s?.fontSize??"medium",fontFamily:s?.fontFamily??"helvetica",colorTheme:s?.colorTheme??"classic",cardSize:s?.cardSize??"standard"}),L("Place cards PDF downloaded","success")}catch(C){console.error("Failed to generate place cards:",C),L("Failed to generate PDF. Please try again.","error")}finally{p(!1)}};return e.jsxs("div",{className:"dashboard-view",children:[e.jsxs("div",{className:"dashboard-grid",children:[e.jsxs("div",{className:"dashboard-card event-summary",children:[e.jsx("h3",{children:"Event Details"}),e.jsxs("div",{className:"event-info",children:[e.jsx("input",{type:"text",className:"event-name-input",value:a.name,onChange:s=>r(s.target.value),placeholder:"Event name..."}),e.jsxs("div",{className:"event-meta",children:[e.jsxs("select",{className:"event-type-select",value:a.eventType,onChange:s=>c(s.target.value),children:[e.jsx("option",{value:"wedding",children:"Wedding"}),e.jsx("option",{value:"corporate",children:"Corporate"}),e.jsx("option",{value:"social",children:"Social"}),e.jsx("option",{value:"other",children:"Other"})]}),a.date&&e.jsx("span",{className:"event-date",children:a.date})]})]})]}),e.jsxs("div",{className:"dashboard-card stats-overview",children:[e.jsx("h3",{children:"Overview"}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx(R,{value:T,className:"stat-value"}),e.jsx("span",{className:"stat-label",children:"Total Guests"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx(R,{value:k,className:"stat-value"}),e.jsx("span",{className:"stat-label",children:"Tables"})]}),e.jsxs("div",{className:"stat-item confirmed",children:[e.jsx(R,{value:A,className:"stat-value"}),e.jsx("span",{className:"stat-label",children:"Confirmed"})]}),e.jsxs("div",{className:"stat-item warning",children:[e.jsx(R,{value:I,className:"stat-value"}),e.jsx("span",{className:"stat-label",children:"Pending"})]}),e.jsxs("div",{className:"stat-item error",children:[e.jsx(R,{value:B,className:"stat-value"}),e.jsx("span",{className:"stat-label",children:"Declined"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx(R,{value:le,className:"stat-value"}),e.jsx("span",{className:"stat-label",children:"Unassigned"})]})]})]}),e.jsxs("div",{className:"dashboard-card progress-card",children:[e.jsx("h3",{children:"Seating Progress"}),e.jsxs("div",{className:"progress-ring-container",children:[e.jsxs("svg",{className:"progress-ring",viewBox:"0 0 120 120",children:[e.jsx("circle",{className:"progress-ring-bg",cx:"60",cy:"60",r:"52",fill:"none",strokeWidth:"12"}),e.jsx("circle",{className:"progress-ring-fill",cx:"60",cy:"60",r:"52",fill:"none",strokeWidth:"12",strokeDasharray:`${H/100*327} 327`,strokeLinecap:"round"})]}),e.jsxs("div",{className:"progress-text",children:[e.jsxs("span",{className:"progress-percentage",children:[e.jsx(R,{value:H}),"%"]}),e.jsx("span",{className:"progress-label",children:"Complete"})]})]}),e.jsxs("div",{className:"progress-detail",children:[G," / ",T," guests seated"]}),U>0&&e.jsxs("div",{className:"capacity-info",children:["Total capacity: ",U," seats"]})]}),e.jsxs("div",{className:"dashboard-card quick-actions",children:[e.jsx("h3",{children:"Quick Actions"}),e.jsxs("div",{className:"actions-grid",children:[e.jsxs("button",{className:"action-btn primary",onClick:()=>l("canvas"),children:[e.jsx("span",{className:"action-icon",children:"+"}),e.jsx("span",{children:"Add Tables"})]}),e.jsxs("button",{className:"action-btn primary",onClick:()=>l("guests"),children:[e.jsx("span",{className:"action-icon",children:"+"}),e.jsx("span",{children:"Manage Guests"})]}),e.jsxs("button",{className:"action-btn outline",onClick:ie,children:[e.jsx("span",{className:"action-icon",children:"â†“"}),e.jsx("span",{children:"Export Event"})]}),e.jsxs("button",{className:"action-btn secondary",onClick:()=>N(!0),disabled:T===0&&k===0,children:[e.jsx("span",{className:"action-icon",children:"â†—"}),e.jsx("span",{children:"Share View"})]})]})]}),e.jsxs("div",{className:"dashboard-card print-materials",children:[e.jsx("h3",{children:"Print Materials"}),e.jsx("p",{className:"print-materials-description",children:"Generate printable PDFs for your event"}),e.jsxs("div",{className:"print-materials-grid",children:[e.jsxs("button",{className:"print-material-btn",onClick:oe,disabled:k===0||i,children:[e.jsx("div",{className:"print-material-icon",children:i?e.jsx("div",{className:"btn-loading-spinner"}):e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),e.jsx("path",{d:"M12 8v8M8 12h8"})]})}),e.jsxs("div",{className:"print-material-info",children:[e.jsx("span",{className:"print-material-title",children:i?"Loading preview...":"Table Cards"}),e.jsx("span",{className:"print-material-desc",children:"Tent cards for each table"})]}),e.jsxs("span",{className:"print-material-count",children:[k," cards"]})]}),e.jsxs("button",{className:"print-material-btn",onClick:ce,disabled:G===0||A===0||o,children:[e.jsx("div",{className:"print-material-icon",children:o?e.jsx("div",{className:"btn-loading-spinner"}):e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),e.jsxs("div",{className:"print-material-info",children:[e.jsx("span",{className:"print-material-title",children:o?"Loading preview...":"Place Cards"}),e.jsx("span",{className:"print-material-desc",children:"Name cards for seated guests"})]}),e.jsxs("span",{className:"print-material-count",children:[a.guests.filter(s=>s.tableId&&s.rsvpStatus==="confirmed").length," cards"]})]})]})]}),e.jsxs("div",{className:"dashboard-card tables-summary",children:[e.jsxs("div",{className:"card-header-with-action",children:[e.jsx("h3",{children:"Tables"}),a.tables.length>0&&e.jsxs("div",{className:"tables-header-actions",children:[e.jsxs("button",{className:"qr-print-btn",onClick:()=>n(!0),title:"Print all table QR codes",children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M3 11h8V3H3v8zm2-6h4v4H5V5zm8-2v8h8V3h-8zm6 6h-4V5h4v4zM3 21h8v-8H3v8zm2-6h4v4H5v-4z"})}),"Print QR Codes"]}),e.jsx("button",{className:"qr-help-btn",onClick:()=>b(!0),title:"Learn about QR codes",children:"?"})]})]}),a.tables.length===0?e.jsx(Te,{variant:"tables",title:"No tables yet",description:"Create your floor plan to start arranging seating.",action:{label:"Create Floor Plan",onClick:()=>l("canvas")}}):e.jsx("div",{className:"tables-grid",children:a.tables.map(s=>{const m=a.guests.filter(C=>C.tableId===s.id).length;return e.jsxs("div",{className:"table-summary-item",children:[e.jsxs("div",{className:"table-info",children:[e.jsx("span",{className:"table-name",children:s.name}),e.jsx("span",{className:`table-shape ${s.shape}`,children:s.shape})]}),e.jsxs("div",{className:"table-occupancy",children:[e.jsx("div",{className:"occupancy-bar",style:{width:`${m/s.capacity*100}%`}}),e.jsxs("span",{className:"occupancy-text",children:[m,"/",s.capacity]})]})]},s.id)})})]})]}),h&&e.jsx(ke,{onClose:()=>n(!1)}),e.jsx(ze,{isOpen:j,onClose:Q,pdfUrl:t,title:S==="table"?"Table Cards Preview":"Place Cards Preview",onDownload:he,isGenerating:O,type:S,onOptionsChange:de}),e.jsx(ve,{isOpen:u,onClose:()=>b(!1),onComplete:()=>b(!1),customSteps:xe}),e.jsx(ge,{isOpen:v,onClose:()=>N(!1),event:a}),w&&e.jsx(be,{onClose:()=>q(!1),onSuccess:()=>q(!0),source:"export_prompt"})]})}export{Je as DashboardView};
